---
title: "Assignment: Data mining and statistical tests\n"
author: "Victor Salvat"
date: "`r format(Sys.time(), '%d %B, %Y, %H:%M')`"
output:
  html_document:
    df_print: paged
    code_folding: hide
    toc: false
    number_sections: true
---

# Load data

```{r load-data}
nonuse <- read.csv("data/test_data/NonUse.csv", sep = ",", header = TRUE)
head(nonuse)
summary(nonuse)
```

This file contains measures of upper extremity non-use in stroke patients. The variables are:

    PANU: Proximal Arm Non Use
    SANU: Shoulder Antepulsion Non Use
    EENU: Elbow Extension Non Use
    
In your notebook, make a clear description of the experiment, the variables and the data. Do not forget to give the units of each variable, and the range of possible values.

| name | description | unit | range |
|:--|:--------|-|--|
| PANU | Proximal Arm Non Use | % | 0-100 |
| SANU | Shoulder Antepulsion Non Use | % | 0-100 |
| EENU | Elbow Extension Non Use | % | 0-100 |


## Corelation analysis
Below are some questions to guide your analysis.

- Is PANU correlated with SANU and/or EENU?

```{r correlation-sanu}
cor.test(nonuse$PANU, nonuse$EENU, method = "spearman")
```
```{r correlation-eenu}
cor.test(nonuse$PANU, nonuse$SANU, method = "spearman")
```

- Visualize the PANU-SANU relationship (and the PANU-EENU relationship)

```{r plot-sanu, message=FALSE, warning=FALSE}
library(ggplot2)
ggplot(nonuse, aes(x = SANU, y = PANU)) +
  geom_point() +
  xlim(-100, 100) +
  ylim(-100, 100) +
  labs(title = "Scatter plot of PANU vs SANU",
       x = "SANU (%)",
       y = "PANU (%)") +
  theme_minimal()
```

```{r plot-eenu, message=FALSE, warning=FALSE}
library(ggplot2)
ggplot(nonuse, aes(x = EENU, y = PANU)) +
  geom_point() +
  xlim(-100, 100) +
  ylim(-100, 100) +
  labs(title = "Scatter plot of PANU vs EENU",
       x = "EENU (%)",
       y = "PANU (%)") +
  theme_minimal()
```


- Perform a linear regression for PANU-SANU (and for PANU-EENU)

We do not want to predict a linear relationship between PANU and SANU & EENU, but we do it because it is asked in the exercise...

```{r plot-sanu_2, message=FALSE, warning=FALSE}
library(ggplot2)
ggplot(nonuse, aes(x = SANU, y = PANU)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  labs(title = "Scatter plot of PANU vs SANU",
       x = "SANU (%)",
       y = "PANU (%)") +
  theme_minimal()
```
```{r plot-eenu_2, message=FALSE, warning=FALSE}
library(ggplot2)
ggplot(nonuse, aes(x = EENU, y = PANU)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  labs(title = "Scatter plot of PANU vs EENU",
       x = "EENU (%)",
       y = "PANU (%)") +
  theme_minimal()
```

- Give the regression equations: PANU = a * SANU + b and PANU = a * EENU + b
```{r}
lm_sanu <- lm(SANU ~ PANU, data = nonuse)
summary(lm_sanu)
coef(lm_sanu)
slope_sanu <- coef(lm_sanu)[2]
intercept_sanu <- coef(lm_sanu)[1]
cat("Regression equation: SANU =", slope_sanu, "* PANU +", intercept_sanu, "\n")
```
```{r}
lm_eenu <- lm(EENU ~ PANU, data = nonuse)
summary(lm_eenu)
coef(lm_eenu)
slope_eenu <- coef(lm_eenu)[2]
intercept_eenu <- coef(lm_eenu)[1]
cat("Regression equation: EENU =", slope_eenu, "* PANU +", intercept_eenu, "\n")
```
- Summarize your results as you would do in your master’s thesis report, or as in a scientific article (e.g., What sentence will you write in the article explaining your result?)

Spearman correlations revealed a strong positive association between proximal arm non-use (PANU) and elbow non-use (EENU), whereas the association between PANU and shoulder non-use (SANU) was weak and not significant; linear regression confirmed EENU as the only significant predictor of PANU.


- What are the limits of your analysis?

The analysis was constrained by substantial missing data in SANU and EENU, which reduced effective sample size and may have biased the results. The repeated-measures structure (eight observations per patient) was not fully accounted for in the correlation and simple regression models, potentially inflating significance levels. Moreover, Spearman’s rho captures monotonic but not strictly linear associations, limiting comparability with linear regression coefficients. Finally, the number of patients was not very large and there were some extreme values restricting the generalisability of the findings.


End of part 1.


-------------------------------------------------------------------------------
## Statistical tests

# 2.1 Make clear what is a statistical test, and when to use it.

- What is a median? A mean?
The median is the middle value in a dataset when ordered from smallest to largest; it divides the data into two equal halves.
[Reference: Weiss, N. A. (2017). Introductory Statistics (10th ed.). Pearson]

The mean (or average) is the sum of all values divided by the number of observations; it represents the central tendency of a dataset.
[Reference: Moore, D. S., Notz, W. I., & Fligner, M. A. (2018). The Basic Practice of Statistics (8th ed.). W.H. Freeman]

- What is a variance? A standard deviation?
Variance measures the average squared deviation of each data point from the mean, indicating how spread out the values are in a dataset.
[Reference: De Veaux, R. D., Velleman, P. F., & Bock, D. E. (2016). Stats: Data and Models (4th ed.). Pearson]

- What is a normal distribution?
A normal distribution is a symmetric, bell-shaped probability distribution characterized by its mean and standard deviation, where most values cluster around the mean and probabilities taper off equally in both directions.
[Reference: Freedman, D., Pisani, R., & Purves, R. (2007). Statistics (4th ed.). W.W. Norton & Company]

- What is a statistical test?
A statistical test is a method used to make inferences or decisions about a population based on sample data, by evaluating hypotheses and determining the likelihood that observed differences or relationships occurred by chance.
[Reference: Agresti, A., & Finlay, B. (2009). Statistical Methods for the Social Sciences (4th ed.). Pearson]

- When to use a statistical test?
Statistical tests are used when you want to compare groups, assess relationships between variables, or test hypotheses about population parameters based on sample data. They are appropriate when you have collected data and need to determine if observed patterns are statistically significant or likely due to random variation.
[Reference: Field, A. (2013). Discovering Statistics Using IBM SPSS Statistics (4th ed.). SAGE Publications]

- What is a parametric test? A non-parametric test?
Parametric tests are statistical tests that assume the data follows a specific distribution, typically a normal distribution, and rely on parameters such as the mean and standard deviation. Examples include t-tests and ANOVA.
[Reference: Zar, J. H. (2010). Biostatistical Analysis (5th ed.). Pearson]

Non-parametric tests do not assume a specific distribution and are used when data do not meet the assumptions required for parametric tests. They often rely on ranks or medians rather than means. Examples include the Mann-Whitney U test and the Kruskal-Wallis test.
[Reference: Conover, W. J. (1999). Practical Nonparametric Statistics (3rd ed.). Wiley]

- What are the assumptions of parametric tests?
Parametric tests typically assume:
1. The data are normally distributed.
2. Homogeneity of variance (equal variances across groups).
3. Independence of observations.
4. The data are measured at an interval or ratio scale.
[Reference: Field, A. (2013). Discovering Statistics Using IBM SPSS Statistics (4th ed.). SAGE Publications]

- What are the assumptions of non-parametric tests?
Non-parametric tests generally have fewer assumptions, but common ones include:
1. Independence of observations.
2. The data can be ordinal or continuous, but do not need to be normally distributed.
3. The samples are randomly drawn from the population.
[Reference: Conover, W. J. (1999). Practical Nonparametric Statistics (3rd ed.). Wiley]

- What is a p-value?
A p-value is the probability of obtaining test results at least as extreme as the observed results, assuming that the null hypothesis is true. It quantifies the evidence against the null hypothesis; a smaller p-value indicates stronger evidence to reject the null hypothesis.
[Reference: Agresti, A., & Finlay, B. (2009). Statistical Methods for the Social Sciences (4th ed.). Pearson]

- What is the risk of error when using a statistical test?
The risk of error when using a statistical test primarily refers to Type I and Type II errors. A Type I error occurs when the null hypothesis is incorrectly rejected (false positive), while a Type II error occurs when the null hypothesis is incorrectly accepted (false negative). The significance level (alpha) set for the test determines the acceptable risk of a Type I error, commonly set at 0.05.
[Reference: Field, A. (2013). Discovering Statistics Using IBM SPSS Statistics (4th ed.). SAGE Publications]

- What is the difference between a paired and an unpaired test?
A paired test is used when the same subjects are measured under two different conditions or at two different times, allowing for direct comparison of the paired observations. An example is the paired t-test.
[Reference: Zar, J. H. (2010). Biostatistical Analysis (5th ed.). Pearson]

The questions were answered using Co-Pilot and ClaudeAI (Sonnet 4.5)

---
# 2.2 Effect of treatment over time
This is a very classical question in clinical or sport research: does a treatment-training have an effect over time?

To answer this question scientifically, measurements must be taken before and after treatment, and possibly later, in order to assess whether the effect is lasting or not.

# 2.2.1 The data
Download the file PrePost.csv

- Load the data
```{r load-prepost}
prepost <- read.csv("data/test_data/PrePost.csv", sep = ",", header = TRUE)
head(prepost)
summary(prepost)
```
This file contains before/after measurements. The treatment is a rehabilitation training for individuals with cardiac conditions.

The variables are:
- ID: subject identifier
- Time: time of measurement (Pre or Post)
- Score: performance score (higher is better)
- Group: group (Control or Treated)

Make a table, with one row per variable, and the following columns:

| Variable | Description | Unit | Possible values | Expected change |
|:--|:----|---|-----|----|
| Time | Time of measurement | N/A | Categorical: "Pre", "Post" | N/A |
| Score | Performance measure | Not specified | Positive numeric values | Increase after treatment |

