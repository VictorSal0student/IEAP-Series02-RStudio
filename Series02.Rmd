---
title: "Assignment: Data mining and statistical tests\n"
author: "Victor Salvat"
date: "`r format(Sys.time(), '%d %B, %Y, %H:%M')`"
output:
  html_document:
    df_print: paged
    code_folding: hide
    toc: false
    number_sections: true
---

# Load data

```{r load-data}
nonuse <- read.csv("data/test_data/NonUse.csv", sep = ",", header = TRUE)
head(nonuse)
summary(nonuse)
```

This file contains measures of upper extremity non-use in stroke patients. The variables are:

    PANU: Proximal Arm Non Use
    SANU: Shoulder Antepulsion Non Use
    EENU: Elbow Extension Non Use
    
In your notebook, make a clear description of the experiment, the variables and the data. Do not forget to give the units of each variable, and the range of possible values.

| name | description | unit | range |
|:--|:--------|-|--|
| PANU | Proximal Arm Non Use | % | 0-100 |
| SANU | Shoulder Antepulsion Non Use | % | 0-100 |
| EENU | Elbow Extension Non Use | % | 0-100 |


## Corelation analysis
Below are some questions to guide your analysis.

- Is PANU correlated with SANU and/or EENU?

```{r correlation-sanu}
cor.test(nonuse$PANU, nonuse$EENU, method = "spearman")
```
```{r correlation-eenu}
cor.test(nonuse$PANU, nonuse$SANU, method = "spearman")
```

- Visualize the PANU-SANU relationship (and the PANU-EENU relationship)

```{r plot-sanu, message=FALSE, warning=FALSE}
library(ggplot2)
ggplot(nonuse, aes(x = SANU, y = PANU)) +
  geom_point() +
  xlim(-100, 100) +
  ylim(-100, 100) +
  labs(title = "Scatter plot of PANU vs SANU",
       x = "SANU (%)",
       y = "PANU (%)") +
  theme_minimal()
```

```{r plot-eenu, message=FALSE, warning=FALSE}
library(ggplot2)
ggplot(nonuse, aes(x = EENU, y = PANU)) +
  geom_point() +
  xlim(-100, 100) +
  ylim(-100, 100) +
  labs(title = "Scatter plot of PANU vs EENU",
       x = "EENU (%)",
       y = "PANU (%)") +
  theme_minimal()
```


- Perform a linear regression for PANU-SANU (and for PANU-EENU)

We do not want to predict a linear relationship between PANU and SANU & EENU, but we do it because it is asked in the exercise...

```{r plot-sanu_2, message=FALSE, warning=FALSE}
library(ggplot2)
ggplot(nonuse, aes(x = SANU, y = PANU)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  labs(title = "Scatter plot of PANU vs SANU",
       x = "SANU (%)",
       y = "PANU (%)") +
  theme_minimal()
```
```{r plot-eenu_2, message=FALSE, warning=FALSE}
library(ggplot2)
ggplot(nonuse, aes(x = EENU, y = PANU)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  labs(title = "Scatter plot of PANU vs EENU",
       x = "EENU (%)",
       y = "PANU (%)") +
  theme_minimal()
```

- Give the regression equations: PANU = a * SANU + b and PANU = a * EENU + b
```{r}
lm_sanu <- lm(SANU ~ PANU, data = nonuse)
summary(lm_sanu)
coef(lm_sanu)
slope_sanu <- coef(lm_sanu)[2]
intercept_sanu <- coef(lm_sanu)[1]
cat("Regression equation: SANU =", slope_sanu, "* PANU +", intercept_sanu, "\n")
```
```{r}
lm_eenu <- lm(EENU ~ PANU, data = nonuse)
summary(lm_eenu)
coef(lm_eenu)
slope_eenu <- coef(lm_eenu)[2]
intercept_eenu <- coef(lm_eenu)[1]
cat("Regression equation: EENU =", slope_eenu, "* PANU +", intercept_eenu, "\n")
```
- Summarize your results as you would do in your master’s thesis report, or as in a scientific article (e.g., What sentence will you write in the article explaining your result?)

Spearman correlations revealed a strong positive association between proximal arm non-use (PANU) and elbow non-use (EENU), whereas the association between PANU and shoulder non-use (SANU) was weak and not significant; linear regression confirmed EENU as the only significant predictor of PANU.


- What are the limits of your analysis?

The analysis was constrained by substantial missing data in SANU and EENU, which reduced effective sample size and may have biased the results. The repeated-measures structure (eight observations per patient) was not fully accounted for in the correlation and simple regression models, potentially inflating significance levels. Moreover, Spearman’s rho captures monotonic but not strictly linear associations, limiting comparability with linear regression coefficients. Finally, the number of patients was not very large and there were some extreme values restricting the generalisability of the findings.


End of part 1.